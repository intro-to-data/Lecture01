---
title: "Week 01, Lecture 02"
output: html_notebook
---



# Lecture Goals:

- Introduce:
    - RMarkdown notebooks
    - R scripts
- Who are you?
- Look at some R code and how this code connects to useful concepts.



# Introduce: RMarkdown notebooks

- This file is an [R Markdown](http://rmarkdown.rstudio.com) Notebook.
    -  Like a data "lab" notebook.
 - Contains plain text (for the humans!) and R code (for the computer).
    - The sections of computer code are called code chunks or code blocks.
 - When code is executed within the notebook, results appear below the code.
 - It is kind of like combining the formatting power of Word with the data power of Excel, but better. (Way better)
- Demonstrate:
    - How to create a new notebook/file/script.
    - How to insert a new code chunk:
        - Clicking on the *Insert Chunk* button on the toolbar
        - Or by pressing *Ctrl+Alt+I*.
    - Execute a code chunk:
        - Click on the *Run* button within the chunk
        - Or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 
- You can preview/run notebooks.
-     - The preview shows you a rendered HTML copy of the contents of the editor. 
- Unlike *Knit*, *Preview* does not run any R code chunks.
- Instead, the output of the chunk when it was last run in the editor is displayed.



# R scripts

For example, [data/clean_data.R](data/clean.R)

- A script I wrote to:
    - remove identifying information from the class survey
    - and make it easier to work with.
- Discuss: What was (is) your reaction to knowing I would use the survey results in class?



# Who are you?

- During the first lecture, I introduced myself.
- Now I'd like to take a stab at introducing you, as a group. 
- And discuss a few things about the nature of data along the way!



# Setup

- This document is very similar to the documents I will share with you for labs.
    - When you open a project in RStudio Cloud, you will find all lecture notes and lab materials.
    -  We will do this on Friday.
- You will find a "Setup" section in each lab.Rmd I give you.
- You _must_ run this section of code _before_ attempting to complete the lab.

```{r message=FALSE, warning=FALSE}
library(knitr)
library(rio)
library(tidyverse)
## <- is the assignment operator in R!
survey <- import("data/survey.csv")
questions <- import("data/questions.csv")
```

## Survey Data

- Our labs will also contain a section where I show you the data.
- This section may also include links to additional information about the data.
    - Not Rick Astley . . . . 
- I may also tell you things I think are important/useful about the data.
- And I will ALWAYS give you the code you need to _see_ the data.
- Before you work with a data set, you should look at it.
    - This seems obvious, but if more people followed this sage advice . . . . 
- Demonstrate:
    - Running a code chunk.
    - Information shown to us by R.

```{r message=FALSE, warning=FALSE, page.printed=TRUE}
survey |> kable()
```

What is in ↑?

- Tidy Data!
    - Each row is a single survey entry.
    - Each column contains the answer for a single question.
    - Each data cell contains the answer for a single student to a single
      question.
    - The grain of this data is student survey or just student since you
      can't have more than one row.
- And now we are going to spend an inordinate amount of time discussing this survey data.
- This data is "tidy".
    - If you would like to learn more about tidy data than you think possible, [Tidy Data](https://vita.had.co.nz/papers/tidy-data.pdf)

## Numeric Data Examples

### Age

**Question:** What is your current age? Provide an integer answer (no decimals or fractions).


```{r}
ggplot(survey, aes(y = age)) +
  geom_boxplot()
```

The average age of a student is `r mean(survey$age, na.rm = TRUE)`
with a standard deviation of +/- `r sd(survey$age, na.rm = TRUE)` and
`r sum(is.na(survey$age))` students chose to not answer this question
(which is fine).

If we look at the answers given:

```{r}
survey |>
  group_by(age) |>
  tally()
```

- We see that several people skipped this question.
- And a few answered it.
- Is this average representative of our class?
- Pretend for a moment that most/all students answered the question.
    - Would that average be representative of our class?
    - Would that average be representative of ACPHS students?
    - Would that average be representative of Albany, NY?
    - No data set is perfect. You need to question/understand the limits of the data you work with.
    - Many statistical errors are caused by overlooking this fundamental statistical reality.
- To gauge representativeness, it would help to know how much data we have:

```{r}
survey |>
  group_by(submitted) |>
  tally()
```

Let's talk about numbers:

- Age is an example of a numeric data type.
- My "analysis" here treats it as a continuous variable, although it
  isn't.
- The average is a measure of [central tendency](https://en.wikipedia.org/wiki/Central_tendency).
- The average, standard deviation, etc. are aggregate statistics and
  they may change, depending on the group/grain.
    - Our raw data is at the student grain.
    - The aggregate data is at the class grain because it contains all
      the answers for all the students in the class.
- Assuming everyone answered this question honestly, this is a good representation of the answers given
 
## Categorical Data Examples

### Degree

**Question:** What is your Degree/Program/Major? Select the option which best describes your degree track:

```{r}
ggplot(survey, aes(x = what_degree)) +
  geom_bar()
```

- Unlike age, there's no average here.
- The measure of centrality we use is mode which is simply the largest group.

### What Year?

**Question:** What year are you in at ACPHS? Select the option that best describes where you are in your educational journey.

```{r}
ggplot(survey, aes(x = what_year)) +
  geom_bar()
```

- I could have just put in numbers here, but I wanted to be sure we
  treated this as a categorical.

### Like Math?

**Question:** Do you like math? 1 + 1 = 2

```{r}
ggplot(survey, aes(x = like_math)) +
  geom_bar()
```

- Do you think these results are representative of ACPHS? 
- Do you think these results are representative of all young adults? 

### Good at Counting?

**Question:** Are you good at counting thing? This is related to the previous question.

```{r}
survey |>
  group_by(good_at_counting) |>
  summarise(n = n())
```

- Counting things is hard and this question was ridiculous.
- Yet categorical data is full of categories which are just as arbitrary, if less funny.
    - [Big Win for Better Data for All: NY Governor Kathy Hochul Signs AA and NH/PI Data Disaggregation Bill into Law!
](https://hcfany.org/big-win-for-better-data-for-all-ny-governor-kathy-hochul-signs-aa-and-nh-pi-data-disaggregation-bill-into-law/)
    - There's just no way to make long links look pretty in RMarkdown.

From the link:

> On December 23, 2021, Governor Kathy Hochul signed the NYS Bill
> S6639/A6896 on Asian American and Native Hawaiian/Pacific Islander
> (AA and NH/PI) data disaggregation into law.
> 
> This law mandates that all State agencies, departments, boards, and
> commissions that already collect demographic data must now collect
> data on the top ten most populous AA ethnic groups and specific
> NH/PI ethnic groups of New York State along with data on languages
> spoken.  The law also specifies that such government entities must
> release such data to the public on an annual basis. This huge
> victory in the fight for better data for all was only made possible
> by over ten years of persistent advocacy by CACF and CACF’s members
> and partners!

Federal Race Categories:

- [Census Quick Facts: Race](https://www.census.gov/quickfacts/fact/note/US/RHI625219)
- OMB requires that race data be collected for a minimum of five groups:
    - White,
    - Black or African American,
    - American Indian or Alaska Native,
    - Asian, and Native Hawaiian or Other Pacific Islander.
- OMB permits the Census Bureau to also use a sixth category - Some Other Race.
- Respondents may report more than one race.
- The concept of race is separate from the concept of Hispanic
  origin. Percentages for the various race categories add to 100
  percent, and should not be combined with the percent Hispanic.

I am using the census as my example here because many agencies and
private organizations in the US base their data collection loosely
around the US Census rules.

Let me be completely frank. The concept of "race" is social. It is based on social norms and constructs, not genetics. And while it is an
important part of an individual's identify, the categories themselves
are often arbitrary and capricious. And, many private systems such as
EHRs, do not allow a person to select more than one race.

- Some people select more than one race on the census but in other
  settings are forced to select only one.
- Analysis of people who select more than one race are also
  complicated because these numbers are usually reported out based on
  only a single race.

Discuss (Friday): Reactions?

### Ever analyzed data?

**Question:** Have you ever analyzed data? You know, with a spreadsheet, or any other tool.

```{r}
ggplot(survey, aes(x = ever_analyzed_data)) +
  geom_bar()
```

OK, so let's pause for a moment. There's more we could do here.

```{r}
survey |>
  group_by(like_math, ever_analyzed_data) |>
  summarise(n = n()) |>
  pivot_wider(names_from = "like_math", values_from = n)
```

- This puts the answers for `like_math` in the first column and the
  answers for `ever_analyzed_data` across the top.
- This arrangement is arbitrary.
- But this is yet another grain. Now it is students per like math
  answers.
- This is called pivoting the data.
- And we can slice, dice, and pivot larger/more complex data sets to
  ask all sorts of interesting questions.

### Belief in climate change

**Question:** How strong is your belief that humans cause climate change?

```{r}
survey |>
  group_by(climate) |>
  summarise(n = n()) |>
  mutate(p = 100*round(n / sum(n), 1))
```
- Demonstration of calculating percents.
- This could have also been asked as a Likert scale.
- And that's a numeric type answer that ordinal.
- Can anyone tell me what ordinal means?

## Free Text Examples

## Favorite kind of pizza?

**Question:** What is your favorite kind of pizza?

```{r page.printed=TRUE}
survey |>
  select(favorite_pizza) |>
  kable()
```

- This question is not actually entirely arbitrary.
- In years past, this class was taught on Thursday evenings and I bought pizza for the midterm/final exams.
- Should I continue this tradition?

### Tried to use data?

**Question:** In the past year have you tried to use data to make any important decisions or to understand the world you live in?

```{r}
survey |> select(id, tried_use_data) |> kable()
```

- This kind of free text entry is a special case.
- There are categories here. For example, I could group these answers into:
    - Yes, No, Unknown, NA
- Important difference with other categorical variables we have seen:
  -  YOU (respondent) would not choose the group.
  -  The researcher (me!) would have that power.
  -  This can be a powerful way to explore a small data set.
  
This is often done early in a research process. But it is always important to know when the respondents choose the group and when someone else chooses the group based on free text entries.
